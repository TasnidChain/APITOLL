# APITOLL Security Scan Config for Shannon
# Usage: ./shannon start URL=https://apitoll.com REPO=/path/to/agentcommerce CONFIG=./apitoll-pentest.yaml

rules:
  focus:
    - description: "Focus on payment API endpoints"
      type: path
      url_path: "/api/*"

    - description: "Focus on discovery and registration"
      type: path
      url_path: "/api/discover/*"

    - description: "Focus on gossip endpoint (no auth, public)"
      type: path
      url_path: "/api/gossip"

    - description: "Focus on dashboard authenticated routes"
      type: path
      url_path: "/dashboard/*"

  avoid:
    - description: "Skip Clerk hosted auth pages"
      type: path
      url_path: "/sign-up"

    - description: "Skip Next.js internals"
      type: path
      url_path: "/_next/*"

    - description: "Skip static assets"
      type: path
      url_path: "/icons/*"

    - description: "Skip service worker"
      type: path
      url_path: "/sw.js"
